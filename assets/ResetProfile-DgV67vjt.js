import{C as d,o as r,n as u,k as a,w as l,E as n,q as f,D as h,v as p}from"./index-DwtaCfGO.js";import{_ as c}from"./index-BGq3NTOk.js";import{V}from"./VSheet-C_Hyj1MI.js";import{V as w}from"./VDialog-X5u0YIHc.js";import{V as y}from"./VForm-C9ylvDdL.js";import{V as i}from"./VTextField-Cx5mEllB.js";import{a as m}from"./VBtn-CkxTN2t3.js";import{V as v}from"./VCard-RJQHm45Z.js";import{V as g}from"./VOtpInput-Bi7eOvMy.js";import"./VField-cmWXXnz-.js";import"./index-BO8FKK4Q.js";import"./VInput-6D98JBOE.js";import"./lazy-CrRX33uZ.js";import"./createSimpleFunctional-CwlLRIoL.js";import"./VAvatar-BXh4o6ar.js";import"./VImg-CUm-mLzW.js";const k={data:()=>({iin:"",phone:"",code:"",dialog:!1,loading:!1,recovery:!1,password:"",password_confirm:"",show1:!1,show2:!1}),methods:{async passwordRecovery(){try{const e=await d.post("client-password-recovery",{iin:this.iin,phone:this.phone,password:this.password,password_confirm:this.password_confirm});console.log("Res",e.data),this.$router.push("/login")}catch(e){console.error(e),alert("Что-то пошло не так")}},async smsValidate(){this.loading=!0;try{const e=await d.post("client-sms-validate",{code:this.code,phone:this.phone});console.log("Res",e.data),e.data.success?this.recovery=e.data.success:alert(e.data.message)}catch(e){console.error(e),alert("Что-то пошло не так")}finally{this.loading=!1,this.dialog=!1}},async smsSend(){try{const e=await d.post("client-sms-send",{iin:this.iin,phone:this.phone});console.log("Res",e.data),this.dialog=!0,alert(e.data.data)}catch(e){console.error(e),alert("Что-то пошло не так")}},async validate(){const{valid:e}=await this.$refs.form.validate();e&&(this.recovery?this.password===this.password_confirm?this.passwordRecovery():alert("Пароли не совпадают"):this.smsSend())},reset(){this.$refs.form.reset()},resetValidation(){this.$refs.form.resetValidation()}}},b={class:"section__auth"},C={key:0},$={class:"d-flex flex-column"},R={class:"section__auth__modal"};function U(e,s,q,B,N,t){return r(),u("div",b,[a(V,{class:"mx-auto",width:"300"},{default:l(()=>[a(y,{ref:"form"},{default:l(()=>[a(i,{disabled:e.recovery,modelValue:e.iin,"onUpdate:modelValue":s[0]||(s[0]=o=>e.iin=o),variant:"outlined",counter:12,rules:[o=>!!o||"Введите ИИН",o=>o&&o.length<=12||"ИИН содержит только 12 цифр"],label:"ИИН",required:""},null,8,["disabled","modelValue","rules"]),a(i,{disabled:e.recovery,modelValue:e.phone,"onUpdate:modelValue":s[1]||(s[1]=o=>e.phone=o),variant:"outlined",counter:12,rules:[o=>!!o||"Введите телефон"],label:"Телефон",required:""},null,8,["disabled","modelValue","rules"]),e.recovery?(r(),u("div",C,[a(i,{"append-icon":e.show1?"mdi-eye":"mdi-eye-off",type:e.show1?"text":"password",modelValue:e.password,"onUpdate:modelValue":s[2]||(s[2]=o=>e.password=o),variant:"outlined",rules:[o=>!!o||"Введите пароль"],label:"Введите новый пароль",required:"","onClick:append":s[3]||(s[3]=o=>e.show1=!e.show1)},null,8,["append-icon","type","modelValue","rules"]),a(i,{"append-icon":e.show2?"mdi-eye":"mdi-eye-off",type:e.show2?"text":"password",modelValue:e.password_confirm,"onUpdate:modelValue":s[4]||(s[4]=o=>e.password_confirm=o),variant:"outlined",rules:[o=>!!o||"Введите пароль",o=>o===e.password||"Пароли не совпадают"],label:"Повторный ввод",required:"","onClick:append":s[5]||(s[5]=o=>e.show2=!e.show2)},null,8,["append-icon","type","modelValue","rules"])])):n("",!0),f("div",$,[e.recovery?n("",!0):(r(),h(m,{key:0,class:"mt-4",color:"grey-darken-4",block:"",onClick:t.validate},{default:l(()=>[p(" Отправить смс на номер ")]),_:1},8,["onClick"])),e.recovery?(r(),h(m,{key:1,class:"mt-4",color:"grey-darken-4",block:"",onClick:t.validate},{default:l(()=>[p(" Подтвердить ")]),_:1},8,["onClick"])):n("",!0)])]),_:1},512)]),_:1}),a(w,{modelValue:e.dialog,"onUpdate:modelValue":s[7]||(s[7]=o=>e.dialog=o),width:"auto"},{default:l(()=>[a(v,null,{default:l(()=>[f("div",R,[a(g,{modelValue:e.code,"onUpdate:modelValue":s[6]||(s[6]=o=>e.code=o),loading:e.loading,length:"4",variant:"underlined"},null,8,["modelValue","loading"]),a(m,{disabled:e.code.length<3,class:"mt-4",color:"grey-darken-4",block:"",onClick:t.smsValidate},{default:l(()=>[p(" Подтвердить ")]),_:1},8,["disabled","onClick"])])]),_:1})]),_:1},8,["modelValue"])])}const M=c(k,[["render",U]]);export{M as default};
