import{p as R,g as P,j as C,k as o,_ as k,a1 as O,P as E,N as w,e as B,f as G,a3 as U,F as D,m as L,b as M,c as W,W as j,l as H,B as y,o as h,n as v,q as t,A as i,w as f,x as r,v as I,s as J,y as z}from"./index-Bv9JDdsZ.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Q}from"./VChip-BvxfoC24.js";import{m as X,V as S,b as Y}from"./VInput-od7ewK1K.js";import{m as Z,V as F,a as $,b as ee}from"./VSelectionControl-CStpLvjt.js";import{V as q}from"./VBtn-BbFvIthX.js";import{a as te,d as se}from"./variant-BN8LjZ0a.js";import"./index-DspfAZ2O.js";import"./VBtnToggle-CaDEBIll.js";import"./VIcon-DCZxdGLj.js";import"./index-D90Wg3_q.js";import"./VAvatar-B6FQSQpx.js";import"./VImg-fOTYweeb.js";const ae="/assets/freedom-D6iI5ME7.svg",oe=R({...Z({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),le=P()({name:"VRadio",props:oe(),setup(e,d){let{slots:a}=d;return C(()=>o(F,k(e,{class:["v-radio",e.class],style:e.style,type:"radio"}),a)),{}}}),re=R({height:{type:[Number,String],default:"auto"},...X(),...O($(),["multiple"]),trueIcon:{type:E,default:"$radioOn"},falseIcon:{type:E,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),ne=P()({name:"VRadioGroup",inheritAttrs:!1,props:re(),emits:{"update:modelValue":e=>!0},setup(e,d){let{attrs:a,slots:m}=d;const s=w(),c=B(()=>e.id||`radio-group-${s}`),n=G(e,"modelValue");return C(()=>{const[_,u]=U(a),b=S.filterProps(e),g=F.filterProps(e),p=m.label?m.label({label:e.label,props:{for:c.value}}):e.label;return o(S,k({class:["v-radio-group",e.class],style:e.style},_,b,{modelValue:n.value,"onUpdate:modelValue":l=>n.value=l,id:c.value}),{...m,default:l=>{let{id:V,messagesId:x,isDisabled:A,isReadonly:T}=l;return o(D,null,[p&&o(Y,{id:V.value},{default:()=>[p]}),o(ee,k(g,{id:V.value,"aria-describedby":x.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:A.value,readonly:T.value,"aria-labelledby":p?V.value:void 0,multiple:!1},u,{modelValue:n.value,"onUpdate:modelValue":N=>n.value=N}),m)])}})}),{}}}),ie=R({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...L(),...te(),...M(),...W()},"VTable"),ce=P()({name:"VTable",props:ie(),setup(e,d){let{slots:a,emit:m}=d;const{themeClasses:s}=j(e),{densityClasses:c}=se(e);return C(()=>o(e.tag,{class:["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!a.top,"v-table--has-bottom":!!a.bottom,"v-table--hover":e.hover},s.value,c.value,e.class],style:e.style},{default:()=>{var n,_,u;return[(n=a.top)==null?void 0:n.call(a),a.default?o("div",{class:"v-table__wrapper",style:{height:H(e.height)}},[o("table",null,[a.default()])]):(_=a.wrapper)==null?void 0:_.call(a),(u=a.bottom)==null?void 0:u.call(a)]}})),{}}}),de={data(){return{selected:null,request:null,status:null,intervalId:null,approved:[],message:null}},watch:{status(e){e!="PROCESSING"&&clearInterval(this.intervalId)}},mounted(){this.requestInfo(),this.requestResult(),this.intervalId=setInterval(()=>{this.requestResult()},5e3)},beforeUnmount(){clearInterval(this.intervalId)},computed:{approvedItem(){return this.approved.find(e=>e.id===parseInt(this.selected))},statusWord(){switch(this.status){case"PROCESSING":return"в процессе";case"APPROVED":return"предварительно одобрено";case"REJECTED":return"отклонено";case"FAILED":return"ошибка запроса";case"ISSUED":return"одобрена";default:return"Неизвестный статус"}},statusFill(){switch(this.status){case"PROCESSING":return"#03A9F4";case"APPROVED":return"#FFC107";case"REJECTED":return"#C62828";case"FAILED":return"#C62828";case"ISSUED":return"#4CAF50";default:return"#212121"}}},methods:{cancelRequest(){y.get(`client-reject-scoring/${this.$route.params.id}`).then(e=>{console.log("response",e),alert("Вы успешно отменили заявку!"),location.reload()}).catch(e=>{console.error(e)})},applyLoan(){y.post("client-sms-confirm",{scoring_id:parseInt(this.$route.params.id),company_id:this.request.company_id,offer:this.approvedItem}).then(e=>{console.log("response",e),this.$router.push(`/request/issued/${this.$route.params.id}`)}).catch(e=>{console.error(e)})},async requestInfo(){try{const e=await y.get(`client-scoring-info/${this.$route.params.id}`);console.log("Res",e.data.data),this.request=e.data.data}catch(e){console.error(e),alert("Что-то пошло не так")}},async requestResult(){try{const e=await y.get(`client-scoring-result/${this.$route.params.id}`);console.log("Res",e.data.data),this.status=e.data.data.status,this.approved=e.data.data.approved,e.data.data.message&&(this.message=e.data.data.message)}catch(e){console.error(e),alert("Что-то пошло не так")}}}},_e={class:"section__cart"},ue={class:"section__cart__item"},me={class:"section__cart__item__title",style:{border:"none","margin-bottom":"0","padding-bottom":"0"}},pe={key:0},he={class:"section__cart__item"},ve=t("h2",{class:"section__cart__item__title"},"Детали заявки",-1),fe={class:"section__cart__item__block"},be=t("span",null,"Номер телефона",-1),ge={class:"section__cart__item__block"},ye=t("span",null,"ИИН",-1),Ve={class:"section__cart__item__block"},Ie=t("span",null,"Магазин",-1),ke={class:"section__cart__item__block"},Re=t("span",null,"Срок кредита",-1),Pe={key:0,class:"section__cart__item"},Ce=t("h2",{class:"section__cart__item__title"},"Детали заявки",-1),Ee={class:"section__cart__item__table"},Se=t("div",{class:"section__cart__item__table__header"},[t("img",{src:ae,alt:""}),i(" ТОО FREEDOM FINANCE ")],-1),qe={class:"section__cart__item__table__td"},De={class:"section__cart__item__table__td"},Fe={class:"section__cart__item__table__td"},xe={class:"section__cart__item"},Ae={class:"section__cart__item__block"},Te=t("span",null,"Время создания",-1),Ne={class:"section__cart__item__block"},Oe=t("span",null,"Время последнего изменения",-1);function we(e,d,a,m,s,c){var n,_,u,b,g,p;return h(),v("div",_e,[t("div",ue,[t("h2",me,[i(" Статус "),o(Q,{color:c.statusFill,variant:"elevated"},{default:f(()=>[i(r(c.statusWord),1)]),_:1},8,["color"])]),s.message?(h(),v("p",pe,"Сообщение: "+r(s.message),1)):I("",!0)]),t("div",he,[ve,t("div",fe,[be,i(),t("strong",null,r((n=s.request)==null?void 0:n.iin),1)]),t("div",ge,[ye,i(),t("strong",null,r((_=s.request)==null?void 0:_.phone),1)]),t("div",Ve,[Ie,i(),t("strong",null,r((u=s.request)==null?void 0:u.filial_name),1)]),t("div",ke,[Re,i(),t("strong",null,r((b=s.request)==null?void 0:b.period)+" мес",1)])]),s.approved?(h(),v("div",Pe,[Ce,t("div",Ee,[Se,o(ne,{modelValue:s.selected,"onUpdate:modelValue":d[0]||(d[0]=l=>s.selected=l)},{default:f(()=>[o(ce,null,{default:f(()=>[t("tbody",null,[(h(!0),v(D,null,z(s.approved,l=>(h(),v("tr",{key:l.id},[t("td",null,[o(le,{value:l.id},null,8,["value"])]),t("td",null,[t("div",qe,r(l.productType==="loan"?"Кредит":"Рассрочка"),1)]),t("td",null,[t("div",De,r(l.loanLength)+" мес ",1)]),t("td",null,[t("div",Fe,r(l.monthlyPayment)+" Т ",1)])]))),128))])]),_:1})]),_:1},8,["modelValue"])])])):I("",!0),t("div",xe,[t("div",Ae,[Te,i(),t("strong",null,r((g=s.request)==null?void 0:g.created_at),1)]),t("div",Ne,[Oe,t("strong",null,r((p=s.request)==null?void 0:p.updated_at),1)])]),o(q,{color:"#FFED00",onClick:c.applyLoan,disabled:!s.selected||s.status=="ISSUED"},{default:f(()=>[i(" Оформить кредит ")]),_:1},8,["onClick","disabled"]),s.status=="APPROVED"?(h(),J(q,{key:1,class:"mt-1",color:"grey-darken-4",onClick:c.cancelRequest},{default:f(()=>[i(" Отменить заявку ")]),_:1},8,["onClick"])):I("",!0)])}const Ye=K(de,[["render",we]]);export{Ye as default};
