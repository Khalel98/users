import{p as ue,g as ce,f as de,e as q,K as V,G as _e,aa as fe,ag as me,U as p,L as ve,j as he,a3 as ge,k as o,_ as G,F as H,Q as X,Z as xe,ap as Ve,a5 as z,ar as pe,l as ye,ac as we,B as O,o as y,n as L,q as a,A as u,w as h,x as v,v as N,s as Y}from"./index-DyZQ4_o7.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Ie}from"./VChip-DsfRV5xZ.js";import{V as j}from"./VBtn-CepX3wL6.js";import{V as Ce}from"./VDialog-hjY7q-jG.js";import{V as Fe}from"./VCard-BMj_-Ey8.js";import{m as be,a as Re,b as Se,c as Pe,f as Ee,V as De}from"./VForm-ClAJgesY.js";import{m as qe,u as Ne,V as $}from"./VInput-BQUj_6S5.js";import{I as Ae}from"./index-CNlS3hez.js";import"./VBtnToggle-DGAx-FbG.js";import"./index-D5hQC0w5.js";import"./VIcon-DjvlQA_0.js";import"./VAvatar-lA9f508U.js";import"./createSimpleFunctional-8LFOwi8M.js";const Be=ue({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...qe(),...be()},"VTextarea"),Ue=ce()({name:"VTextarea",directives:{Intersect:Ae},inheritAttrs:!1,props:Be(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,d){let{attrs:w,emit:A,slots:t}=d;const n=de(e,"modelValue"),{isFocused:_,focus:k,blur:I}=Ne(e),C=q(()=>typeof e.counterValue=="function"?e.counterValue(n.value):(n.value||"").toString().length),F=q(()=>{if(w.maxlength)return w.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function b(s,i){var l,c;!e.autofocus||!s||(c=(l=i[0].target)==null?void 0:l.focus)==null||c.call(l)}const r=V(),R=V(),J=_e(""),S=V(),ee=q(()=>e.persistentPlaceholder||_.value||e.active);function B(){var s;S.value!==document.activeElement&&((s=S.value)==null||s.focus()),_.value||k()}function te(s){B(),A("click:control",s)}function ae(s){A("mousedown:control",s)}function se(s){s.stopPropagation(),B(),z(()=>{n.value="",pe(e["onClick:clear"],s)})}function oe(s){var l;const i=s.target;if(n.value=i.value,(l=e.modelModifiers)!=null&&l.trim){const c=[i.selectionStart,i.selectionEnd];z(()=>{i.selectionStart=c[0],i.selectionEnd=c[1]})}}const g=V(),P=V(+e.rows),U=q(()=>["plain","underlined"].includes(e.variant));fe(()=>{e.autoGrow||(P.value=+e.rows)});function x(){e.autoGrow&&z(()=>{if(!g.value||!R.value)return;const s=getComputedStyle(g.value),i=getComputedStyle(R.value.$el),l=parseFloat(s.getPropertyValue("--v-field-padding-top"))+parseFloat(s.getPropertyValue("--v-input-padding-top"))+parseFloat(s.getPropertyValue("--v-field-padding-bottom")),c=g.value.scrollHeight,E=parseFloat(s.lineHeight),M=Math.max(parseFloat(e.rows)*E+l,parseFloat(i.getPropertyValue("--v-input-control-height"))),T=parseFloat(e.maxRows)*E+l||1/0,m=we(c??0,M,T);P.value=Math.floor((m-l)/E),J.value=ye(m)})}me(x),p(n,x),p(()=>e.rows,x),p(()=>e.maxRows,x),p(()=>e.density,x);let f;return p(g,s=>{s?(f=new ResizeObserver(x),f.observe(g.value)):f==null||f.disconnect()}),ve(()=>{f==null||f.disconnect()}),he(()=>{const s=!!(t.counter||e.counter||e.counterValue),i=!!(s||t.details),[l,c]=ge(w),{modelValue:E,...M}=$.filterProps(e),T=Re(e);return o($,G({ref:r,modelValue:n.value,"onUpdate:modelValue":m=>n.value=m,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":U.value},e.class],style:e.style},l,M,{centerAffix:P.value===1&&!U.value,focused:_.value}),{...t,default:m=>{let{id:D,isDisabled:W,isDirty:K,isReadonly:ne,isValid:le}=m;return o(Se,G({ref:R,style:{"--v-textarea-control-height":J.value},onClick:te,onMousedown:ae,"onClick:clear":se,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},T,{id:D.value,active:ee.value||K.value,centerAffix:P.value===1&&!U.value,dirty:K.value||e.dirty,disabled:W.value,focused:_.value,error:le.value===!1}),{...t,default:re=>{let{props:{class:Q,...Z}}=re;return o(H,null,[e.prefix&&o("span",{class:"v-text-field__prefix"},[e.prefix]),X(o("textarea",G({ref:S,class:Q,value:n.value,onInput:oe,autofocus:e.autofocus,readonly:ne.value,disabled:W.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:B,onBlur:I},Z,c),null),[[xe("intersect"),{handler:b},null,{once:!0}]]),e.autoGrow&&X(o("textarea",{class:[Q,"v-textarea__sizer"],id:`${Z.id}-sizer`,"onUpdate:modelValue":ie=>n.value=ie,ref:g,readonly:!0,"aria-hidden":"true"},null),[[Ve,n.value]]),e.suffix&&o("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:i?m=>{var D;return o(H,null,[(D=t.details)==null?void 0:D.call(t,m),s&&o(H,null,[o("span",null,null),o(Pe,{active:e.persistentCounter||_.value,value:C.value,max:F.value,disabled:e.disabled},t.counter)])])}:void 0})}),Ee({},r,R,S)}}),Me={data(){return{selected:null,request:null,status:null,intervalId:null,approved:[],message:null,redirect_url:null,dialog:!1,returnMessage:""}},watch:{status(e){e==="ISSUED"&&clearInterval(this.intervalId)}},mounted(){this.requestInfo(),this.requestResult(),this.intervalId=setInterval(()=>{this.requestResult()},5e3)},beforeUnmount(){clearInterval(this.intervalId)},computed:{approvedItem(){return this.approved.find(e=>e.id===parseInt(this.selected))},statusWord(){switch(this.status){case"PROCESSING":return"в процессе";case"APPROVED":return"предварительно одобрено";case"REJECTED":return"отклонено";case"FAILED":return"ошибка запроса";case"ISSUED":return"одобрена";default:return"Неизвестный статус"}},statusFill(){switch(this.status){case"PROCESSING":return"#03A9F4";case"APPROVED":return"#FFC107";case"REJECTED":return"#C62828";case"FAILED":return"#C62828";case"ISSUED":return"#4CAF50";default:return"#212121"}}},methods:{async validate(){const{valid:e}=await this.$refs.form.validate();e&&this.refundNotification()},async refundNotification(){try{const e=await O.post("client-refund-notification",{message:this.returnMessage,scoring_id:this.$route.params.id});console.log("Res",e)}catch(e){console.error(e),alert("Что-то пошло не так")}finally{this.dialog=!1}},async requestInfo(){try{const e=await O.get(`client-scoring-info/${this.$route.params.id}`);console.log("Res",e.data.data),this.request=e.data.data}catch(e){console.error(e),alert("Что-то пошло не так")}},async requestResult(){try{const e=await O.get(`client-check-status-scoring/${this.$route.params.id}`);console.log("Res",e.data),this.status=e.data.status,e.data.redirect_url&&(this.redirect_url=e.data.redirect_url)}catch(e){console.error(e)}}}},Te={class:"section__cart"},Ge={class:"section__cart__item"},He={class:"section__cart__item__title",style:{border:"none","margin-bottom":"0","padding-bottom":"0"}},ze={key:0},Oe={class:"section__cart__item"},Le=a("h2",{class:"section__cart__item__title"},"Детали заявки",-1),je={class:"section__cart__item__block"},Je=a("span",null,"Номер телефона",-1),We={class:"section__cart__item__block"},Ke=a("span",null,"ИИН",-1),Qe={class:"section__cart__item__block"},Ze=a("span",null,"Магазин",-1),Xe={class:"section__cart__item__block"},Ye=a("span",null,"Срок кредита",-1),$e={class:"section__cart__item"},et={class:"section__cart__item__block"},tt=a("span",null,"Время создания",-1),at={class:"section__cart__item__block"},st=a("span",null,"Время последнего изменения",-1),ot=["href"],nt={class:"section__auth__modal"},lt=a("div",{class:"section__auth__modal__title"},"Вернуть товар",-1),rt=a("div",{class:"section__auth__modal__subtitle"}," Напишите причину возврата ",-1),it={class:"d-flex flex-column"};function ut(e,d,w,A,t,n){var _,k,I,C,F,b;return y(),L("div",Te,[a("div",Ge,[a("h2",He,[u(" Статус "),o(Ie,{color:n.statusFill,variant:"elevated"},{default:h(()=>[u(v(n.statusWord),1)]),_:1},8,["color"])]),t.message?(y(),L("p",ze,"Сообщение: "+v(t.message),1)):N("",!0)]),a("div",Oe,[Le,a("div",je,[Je,u(),a("strong",null,v((_=t.request)==null?void 0:_.iin),1)]),a("div",We,[Ke,u(),a("strong",null,v((k=t.request)==null?void 0:k.phone),1)]),a("div",Qe,[Ze,u(),a("strong",null,v((I=t.request)==null?void 0:I.filial_name),1)]),a("div",Xe,[Ye,u(),a("strong",null,v((C=t.request)==null?void 0:C.period)+" мес",1)])]),a("div",$e,[a("div",et,[tt,u(),a("strong",null,v((F=t.request)==null?void 0:F.created_at),1)]),a("div",at,[st,a("strong",null,v((b=t.request)==null?void 0:b.updated_at),1)])]),t.status!="ISSUED"?(y(),L("a",{key:0,href:t.redirect_url,target:"_blank",style:{"text-decoration":"none"}},[t.redirect_url?(y(),Y(j,{key:0,color:"#FFED00",block:""},{default:h(()=>[u(" Пройти верификацию ")]),_:1})):N("",!0)],8,ot)):N("",!0),t.status=="ISSUED"?(y(),Y(j,{key:1,class:"mt-1",color:"grey-darken-4",onClick:d[0]||(d[0]=r=>t.dialog=!t.dialog)},{default:h(()=>[u(" Вернуть товар ")]),_:1})):N("",!0),o(Ce,{modelValue:t.dialog,"onUpdate:modelValue":d[2]||(d[2]=r=>t.dialog=r),"max-width":"500"},{default:h(()=>[o(Fe,null,{default:h(()=>[a("div",nt,[lt,rt,o(De,{ref:"form",class:"mt-4"},{default:h(()=>[o(Ue,{modelValue:t.returnMessage,"onUpdate:modelValue":d[1]||(d[1]=r=>t.returnMessage=r),variant:"outlined",counter:250,rules:[r=>!!r||"Введите причину",r=>r&&r.length<=250||"Максимум 250 символов"],label:"Причина",required:""},null,8,["modelValue","rules"]),a("div",it,[o(j,{class:"mt-4",color:"grey-darken-4",block:"",onClick:n.validate},{default:h(()=>[u(" Вернуть ")]),_:1},8,["onClick"])])]),_:1},512)])]),_:1})]),_:1},8,["modelValue"])])}const It=ke(Me,[["render",ut]]);export{It as default};
