import{p as ue,g as ce,f as de,e as q,y as V,K as _e,aa as fe,A as me,z as y,O as ve,j as he,a3 as ge,k as o,B as z,F as G,S as Y,_ as xe,al as Ve,a5 as H,ap as ye,l as pe,ac as we,C as O,o as p,n as j,q as a,v as u,w as h,s as v,E as N,D as Z}from"./index-DnQ6OKSw.js";import{I as ke,_ as Ie}from"./index-CupvviZ7.js";import{V as Ce}from"./VChip-DCmRZ6U0.js";import{a as J}from"./VBtn-C47xwbls.js";import{V as Fe}from"./VDialog-j1ayR-5L.js";import{V as Se}from"./VCard-vGOhKcyp.js";import{m as be,a as Re,b as Ee,c as Pe,f as De,V as qe}from"./VForm-CEkHOy_6.js";import{m as Ne,u as Ae,V as $}from"./VInput-CmkBPAq2.js";import"./index-f6VbHwI-.js";import"./VAvatar-DODuEVSm.js";import"./VImg-DsdApsiY.js";import"./lazy-Cvi_GxTl.js";import"./createSimpleFunctional-Bw1jLSAo.js";const Be=ue({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...Ne(),...be()},"VTextarea"),Me=ce()({name:"VTextarea",directives:{Intersect:ke},inheritAttrs:!1,props:Be(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,d){let{attrs:w,emit:A,slots:t}=d;const n=de(e,"modelValue"),{isFocused:_,focus:k,blur:I}=Ae(e),C=q(()=>typeof e.counterValue=="function"?e.counterValue(n.value):(n.value||"").toString().length),F=q(()=>{if(w.maxlength)return w.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function S(s,i){var l,c;!e.autofocus||!s||(c=(l=i[0].target)==null?void 0:l.focus)==null||c.call(l)}const r=V(),b=V(),L=_e(""),R=V(),ee=q(()=>e.persistentPlaceholder||_.value||e.active);function B(){var s;R.value!==document.activeElement&&((s=R.value)==null||s.focus()),_.value||k()}function te(s){B(),A("click:control",s)}function ae(s){A("mousedown:control",s)}function se(s){s.stopPropagation(),B(),H(()=>{n.value="",ye(e["onClick:clear"],s)})}function oe(s){var l;const i=s.target;if(n.value=i.value,(l=e.modelModifiers)!=null&&l.trim){const c=[i.selectionStart,i.selectionEnd];H(()=>{i.selectionStart=c[0],i.selectionEnd=c[1]})}}const g=V(),E=V(+e.rows),M=q(()=>["plain","underlined"].includes(e.variant));fe(()=>{e.autoGrow||(E.value=+e.rows)});function x(){e.autoGrow&&H(()=>{if(!g.value||!b.value)return;const s=getComputedStyle(g.value),i=getComputedStyle(b.value.$el),l=parseFloat(s.getPropertyValue("--v-field-padding-top"))+parseFloat(s.getPropertyValue("--v-input-padding-top"))+parseFloat(s.getPropertyValue("--v-field-padding-bottom")),c=g.value.scrollHeight,P=parseFloat(s.lineHeight),U=Math.max(parseFloat(e.rows)*P+l,parseFloat(i.getPropertyValue("--v-input-control-height"))),T=parseFloat(e.maxRows)*P+l||1/0,m=we(c??0,U,T);E.value=Math.floor((m-l)/P),L.value=pe(m)})}me(x),y(n,x),y(()=>e.rows,x),y(()=>e.maxRows,x),y(()=>e.density,x);let f;return y(g,s=>{s?(f=new ResizeObserver(x),f.observe(g.value)):f==null||f.disconnect()}),ve(()=>{f==null||f.disconnect()}),he(()=>{const s=!!(t.counter||e.counter||e.counterValue),i=!!(s||t.details),[l,c]=ge(w),{modelValue:P,...U}=$.filterProps(e),T=Re(e);return o($,z({ref:r,modelValue:n.value,"onUpdate:modelValue":m=>n.value=m,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":M.value},e.class],style:e.style},l,U,{centerAffix:E.value===1&&!M.value,focused:_.value}),{...t,default:m=>{let{id:D,isDisabled:W,isDirty:K,isReadonly:ne,isValid:le}=m;return o(Ee,z({ref:b,style:{"--v-textarea-control-height":L.value},onClick:te,onMousedown:ae,"onClick:clear":se,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},T,{id:D.value,active:ee.value||K.value,centerAffix:E.value===1&&!M.value,dirty:K.value||e.dirty,disabled:W.value,focused:_.value,error:le.value===!1}),{...t,default:re=>{let{props:{class:Q,...X}}=re;return o(G,null,[e.prefix&&o("span",{class:"v-text-field__prefix"},[e.prefix]),Y(o("textarea",z({ref:R,class:Q,value:n.value,onInput:oe,autofocus:e.autofocus,readonly:ne.value,disabled:W.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:B,onBlur:I},X,c),null),[[xe("intersect"),{handler:S},null,{once:!0}]]),e.autoGrow&&Y(o("textarea",{class:[Q,"v-textarea__sizer"],id:`${X.id}-sizer`,"onUpdate:modelValue":ie=>n.value=ie,ref:g,readonly:!0,"aria-hidden":"true"},null),[[Ve,n.value]]),e.suffix&&o("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:i?m=>{var D;return o(G,null,[(D=t.details)==null?void 0:D.call(t,m),s&&o(G,null,[o("span",null,null),o(Pe,{active:e.persistentCounter||_.value,value:C.value,max:F.value,disabled:e.disabled},t.counter)])])}:void 0})}),De({},r,b,R)}}),Ue={data(){return{selected:null,request:null,status:null,intervalId:null,approved:[],message:null,redirect_url:null,dialog:!1,returnMessage:""}},watch:{status(e){e==="ISSUED"&&clearInterval(this.intervalId)}},mounted(){this.requestInfo(),this.requestResult(),this.intervalId=setInterval(()=>{this.requestResult()},5e3)},beforeUnmount(){clearInterval(this.intervalId)},computed:{approvedItem(){return this.approved.find(e=>e.id===parseInt(this.selected))},statusWord(){switch(this.status){case"PROCESSING":return"в процессе";case"APPROVED":return"предварительно одобрено";case"REJECTED":return"отклонено";case"FAILED":return"ошибка запроса";case"ISSUED":return"одобрена";default:return"Неизвестный статус"}},statusFill(){switch(this.status){case"PROCESSING":return"#03A9F4";case"APPROVED":return"#FFC107";case"REJECTED":return"#C62828";case"FAILED":return"#C62828";case"ISSUED":return"#4CAF50";default:return"#212121"}}},methods:{async validate(){const{valid:e}=await this.$refs.form.validate();e&&this.refundNotification()},async refundNotification(){try{const e=await O.post("client-refund-notification",{message:this.returnMessage,scoring_id:this.$route.params.id});console.log("Res",e)}catch(e){console.error(e),alert("Что-то пошло не так")}finally{this.dialog=!1}},async requestInfo(){try{const e=await O.get(`client-scoring-info/${this.$route.params.id}`);console.log("Res",e.data.data),this.request=e.data.data}catch(e){console.error(e),alert("Что-то пошло не так")}},async requestResult(){try{const e=await O.get(`client-check-status-scoring/${this.$route.params.id}`);console.log("Res",e.data),this.status=e.data.status,e.data.redirect_url&&(this.redirect_url=e.data.redirect_url)}catch(e){console.error(e)}}}},Te={class:"section__cart"},ze={class:"section__cart__item"},Ge={class:"section__cart__item__title",style:{border:"none","margin-bottom":"0","padding-bottom":"0"}},He={key:0},Oe={class:"section__cart__item"},je=a("h2",{class:"section__cart__item__title"},"Детали заявки",-1),Je={class:"section__cart__item__block"},Le=a("span",null,"Номер телефона",-1),We={class:"section__cart__item__block"},Ke=a("span",null,"ИИН",-1),Qe={class:"section__cart__item__block"},Xe=a("span",null,"Магазин",-1),Ye={class:"section__cart__item__block"},Ze=a("span",null,"Срок кредита",-1),$e={class:"section__cart__item"},et={class:"section__cart__item__block"},tt=a("span",null,"Время создания",-1),at={class:"section__cart__item__block"},st=a("span",null,"Время последнего изменения",-1),ot=["href"],nt={class:"section__auth__modal"},lt=a("div",{class:"section__auth__modal__title"},"Вернуть товар",-1),rt=a("div",{class:"section__auth__modal__subtitle"}," Напишите причину возврата ",-1),it={class:"d-flex flex-column"};function ut(e,d,w,A,t,n){var _,k,I,C,F,S;return p(),j("div",Te,[a("div",ze,[a("h2",Ge,[u(" Статус "),o(Ce,{color:n.statusFill,variant:"elevated"},{default:h(()=>[u(v(n.statusWord),1)]),_:1},8,["color"])]),t.message?(p(),j("p",He,"Сообщение: "+v(t.message),1)):N("",!0)]),a("div",Oe,[je,a("div",Je,[Le,u(),a("strong",null,v((_=t.request)==null?void 0:_.iin),1)]),a("div",We,[Ke,u(),a("strong",null,v((k=t.request)==null?void 0:k.phone),1)]),a("div",Qe,[Xe,u(),a("strong",null,v((I=t.request)==null?void 0:I.filial_name),1)]),a("div",Ye,[Ze,u(),a("strong",null,v((C=t.request)==null?void 0:C.period)+" мес",1)])]),a("div",$e,[a("div",et,[tt,u(),a("strong",null,v((F=t.request)==null?void 0:F.created_at),1)]),a("div",at,[st,a("strong",null,v((S=t.request)==null?void 0:S.updated_at),1)])]),t.status!="ISSUED"?(p(),j("a",{key:0,href:t.redirect_url,target:"_blank",style:{"text-decoration":"none"}},[t.redirect_url?(p(),Z(J,{key:0,color:"#FFED00",block:""},{default:h(()=>[u(" Пройти верификацию ")]),_:1})):N("",!0)],8,ot)):N("",!0),t.status=="ISSUED"?(p(),Z(J,{key:1,class:"mt-1",color:"grey-darken-4",onClick:d[0]||(d[0]=r=>t.dialog=!t.dialog)},{default:h(()=>[u(" Вернуть товар ")]),_:1})):N("",!0),o(Fe,{modelValue:t.dialog,"onUpdate:modelValue":d[2]||(d[2]=r=>t.dialog=r),"max-width":"500"},{default:h(()=>[o(Se,null,{default:h(()=>[a("div",nt,[lt,rt,o(qe,{ref:"form",class:"mt-4"},{default:h(()=>[o(Me,{modelValue:t.returnMessage,"onUpdate:modelValue":d[1]||(d[1]=r=>t.returnMessage=r),variant:"outlined",counter:250,rules:[r=>!!r||"Введите причину",r=>r&&r.length<=250||"Максимум 250 символов"],label:"Причина",required:""},null,8,["modelValue","rules"]),a("div",it,[o(J,{class:"mt-4",color:"grey-darken-4",block:"",onClick:n.validate},{default:h(()=>[u(" Вернуть ")]),_:1},8,["onClick"])])]),_:1},512)])]),_:1})]),_:1},8,["modelValue"])])}const kt=Ie(Ue,[["render",ut]]);export{kt as default};
